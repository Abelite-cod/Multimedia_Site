{% extends 'base.html' %}
{% block content %}

<h1>{{ profile_user.username }}'s Profile</h1>

<!-- Profile Picture -->
{% if profile_user.profile.profile_pic %}
    <a href="{{ profile_user.profile.profile_pic.url }}">
    <div class="user-circle"><img src="{{ profile_user.profile.profile_pic.url }}" alt="{{ profile_user.username }}" width="150"></div>
    </a>
    {% else %}
        <div class="avatar-placeholder">{{ profile_user.username|slice:":1"|upper }}</div>
      {% endif %}  

<!-- Bio -->
<p>{{ profile_user.profile.bio }}</p>



<h3>Posts</h3>
<div>
    <h4>Images</h4>
    {% for f in images %}
        <a href="{{ f.file.url }}">
        <img src="{{ f.file.url }}" alt="{{ f.title }}" width="100">
        </a>
    {% empty %}
        <p>No images uploaded.</p>
    {% endfor %}
</div>

<div>
    <h4>Videos</h4>
    {% for f in videos %}
        <a href="{{ f.file.url }}">
        <video width="200" controls>
            <source src="{{ f.file.url }}" type="video/mp4">
        </video>
        </a>
    {% empty %}
        <p>No videos uploaded.</p>
    {% endfor %}
</div>

<div>
    <h4>Audio</h4>
    {% for f in audios %}
        <a href="{{ f.file.url }}">
        <audio controls>
            <source src="{{ f.file.url }}">
        </audio>
        </a>
    {% empty %}
        <p>No audio files uploaded.</p>
    {% endfor %}
</div>

<div>
    <h4>Others</h4>
    {% for f in others %}
        <a href="{{ f.file.url }}">{{ f.title|default:f.filename }}</a>
    {% empty %}
        <p>No other files uploaded.</p>
    {% endfor %}
</div>

{% if is_owner %}
    <h3>Update Profile</h3>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ profile_form.as_p }}
        <button type="submit" name="update_profile">Update Profile</button>
    </form>

    <h3>Upload a File</h3>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ upload_form.as_p }}
        <button type="submit" name="upload_file">Upload</button>
    </form>
{% endif %}

{% endblock %}
